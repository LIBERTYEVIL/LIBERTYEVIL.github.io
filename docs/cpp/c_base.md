# C语言语法基础

# 0x00 注释
在编译时，编译器忽略注释中的所有内容。
注释不要嵌套，否则可能导致编译器解析错误。

### 单行注释
```c
// 一行之内单行注释符号后面的内容全都是注释
```

### 多行注释
```c
/* 包含在内的所有内容，包括换行符全部属于注释 */
```

# 0x01 关键字

- 关键字在C语言中有特定含义，不能用于**标识符**的命名
- 关键字在代码中全部小写

##### 关键字列表

|   关键字    | 说明                                 |
| :------: | ---------------------------------- |
|   auto   | 声明自动变量                             |
|  break   | 跳出当前循环                             |
|   case   | 开关语句分支                             |
|   char   | 声明字符型变量或函数返回值类型                    |
|  const   | 定义常量，如果一个变量被 const 修饰，那么它的值就不能再被改变 |
| continue | 结束当前循环，开始下一轮循环                     |
| default  | 开关语句中的"其它"分支                       |
|    do    | do-while循环语句的循环体                   |
|  double  | 声明双精度浮点型变量或函数返回值类型                 |
|   else   | 条件语句否定分支（与 if 连用）                  |
|   enum   | 声明枚举类型                             |
|  extern  | 声明变量或函数是在其它文件或本文件的其他位置定义           |
|  float   | 声明浮点型变量或函数返回值类型                    |
|   for    | 一种循环语句                             |
|   goto   | 无条件跳转语句                            |
|    if    | 条件语句                               |
|   int    | 声明整型变量或函数                          |
|   long   | 声明长整型变量或函数返回值类型                    |
| register | 声明寄存器变量                            |
|  return  | 子程序返回语句（可以带参数，也可不带参数）              |
|  short   | 声明短整型变量或函数                         |
|  signed  | 声明有符号类型变量或函数                       |
|  sizeof  | 计算数据类型或变量长度（即所占字节数）                |
|  static  | 声明静态变量                             |
|  struct  | 声明结构体类型                            |
|  switch  | 用于开关语句                             |
| typedef  | 用以给数据类型取别名                         |
| unsigned | 声明无符号类型变量或函数                       |
|  union   | 声明共用体类型                            |
|   void   | 声明函数无返回值或无参数，声明无类型指针               |
| volatile | 说明变量在程序执行中可被隐含地改变                  |
|  while   | 循环语句的循环条件                          |

# 0x02 标识符
标识符是程序员在代码中自定义的名字，变量名、函数名、结构体名等。

### 标识符命名的语法规则
- 由字母、数字、下划线组成
- 不能以数字开头
- 不能是关键字

### 标识符命名的一般规范
- 使用英文单词或缩写命名，见名知意
- 变量名使用小写
- 常量名使用全大写
- 文件名使用全小写，下划线分隔单词，可以数字开头

# 0x03 变量
变量在程序的可操作内存中占有一定大小的空间，其类型决定了存储空间的大小和存储方式。

### 1. 基本变量类型及关键字
- char类型存储的是一个字符的ASCII码，所以也是整形数据
- char类型的变量参与运算时按照所存字符的ASCII码以整数型参与运算
- 
![1_basicVarTypes|100%]("./images/1_basicVarTypes.png")

其中long和long修饰的数据类型的变量可能在不同系统占用不同的空间。

![1_varsizedifference|100%]("./images/1_varsizedifference.jpg")

### 2. 变量的定义和初始化
C语言程序中定义后没有初始化的局部变量不会自动初始化为默认值，其中可能包含内存中的各种垃圾数据。全局变量和静态变量的默认初始化值为0，其中指针变量默认为NULL。

##### 1> 定义后初始化
	数据类型 变量名;
	数据类型 变量名1, 变量名2;
	变量名 = 值;
	变量名1 = 值1, 变量名2 = 值2;

##### 2> 定义且初始化
	数据类型 变量名 = 值;
	数据类型 变量名1 = 值1, 变量名2 = 值2;

### 3. 变量类型的转换

##### 1> 隐式转换
- 占用空间大的变量和占用空间小的变量进行运算，占用空间小的变量自动转换为占用空间大的，多出的高位补0。
- char、short 类型在参与运算时自动提升为 int 类型。
- char < short < int < long < long long < float < double

##### 2> 强制转换
` 目标类型 目标变量名 = (目标类型)(原始数据); `
超过目标类型的高位数据直接被去除，留下目标类型存储范围内的数据。

### 4. 作用域规则
作用域是程序中定义的变量所存在的区域，在该区域之外变量就不能被访问。变量按照其作用域分为：
- 在所有函数的外部定义的**全局变量**
- 函数的形式参数、函数体的内部定义**局部变量**

### 5. 布尔类型
C语言中使用`0`来表示条件不成立，使用非`0`的值(一般是`1`)来表示条件成立。直到C99标准增加了_Bool类型，它是一个只能存储0或1的整数类型。
C99还增加了一个标准头文件`stdbool.h`，其中定义了类型`bool`，并设置了常量`true`和`false`来代替1和0表示真和假。

# 0x04 常量
在程序执行过程中，其值不能发生改变的数据，叫做常量。

### 1. 常量的数据类型

| 类型  | 举例    | 前缀              | 后缀                  |
| --- | ----- | --------------- | ------------------- |
| 整数型 | 10    | 0表示8进制，0x表示16进制 | U表示无符号整数，L表示长整数，无顺序 |
| 实数型 | 0.1   |                 | F表示单精度浮点数，默认为双精度    |
| 字符型 | 'c'   | \前缀表示转义字符       |                     |
| 字符串 | "abc" |                 |                     |

**实型常量的表示方式**
1> 一般小数
	如1.0，2.5，3.14，10.24
2> 科学计数法
	如1.345E8表示1.345×10<sup>8</sup>，E不分大小写

### 2. 定义符号常量
- 常量有**字面常量**和**符号常量**
- 字面常量就是字面值
- 符号常量就是被命名的常量

在C语言中有两种符号常量：

##### 1> 宏定义常量
- 这种定义在程序被编译时将程序中所有用到的该常量名直接替换为定义中的字面常量
- 与字面常量的唯一区别就是可以被命名

```c
#define PI 3.14
```

##### 2> const关键字限定的变量
使用const声明的常量与变量有一些共性，这种常量：
- 具有数据类型
- 占据内存空间
- 遵循作用域规则
其实就是一个被规定为不可修改值的变量。
```c
const double PI = 3.14;
```
# 0x05 运算符和表达式

## 表达式
表达式指的是由变量、常量、运算符和函数调用组成的语句，用于计算值或执行特定操作。

## 运算符

### 1. 算术运算
自增自减运算的表达式，运算符在左返回的值为运算后的结果，运算符在右返回的值为原本变量的值，表达式执行完毕后均将运算后的结果返回到原来的变量中去。
- 加(\+)、减(\-)、乘(\*)、除(\/)
- 取余(%)
- 自增(\+\+)、自减(\-\-)

### 2. 位运算符
与、或、异或两个操作数逐位运算，返回结果。
左右移位溢出的值去掉，新增的位补0。
- 按位与、或、取反(&、|、~)
- 按位异或(^)
- 左右移位(<<、>>) **优先级小于加减乘除**

### 3. 赋值运算符
- 直接赋值(=)
- 算数且赋值(\+\=、\-\=、\*\=、\/\=、\%=)
- 位运算赋值(<<=、>>=、&=、^=、|=)

### 4. 关系运算符
关系运算符的两侧是各种表达式，返回一个表示真或假的整数。
满足条件结果为真返回整数1，不满足条件结果为假返回整数0。
此外在各类需要条件表达式的地方填入0表示假，其它非0的值都表示真。
- 等于(\==)、不等于(!=)
- 大于(>)、小于(<)
- 大于等于(>=)、小于等于(<=)

### 5. 逻辑运算符
逻辑运算符的两侧是关系表达式或整数，返回一个表示真或假的整数。
结果为真返回整数1，结果为假返回整数0。
- 逻辑与(&&)
- 逻辑或( || )
- 逻辑非( ! )

### 6. 三元运算符
简短版的if语句。
`条件表达式 ? 表达式1: 表达式2;`
- 条件表达式为真，执行且返回表达式1的值
- 条件表达式为假，执行且返回表达式2的值

### 7. 其它运算符

| 运算符      | 释义                     |
| -------- | ---------------------- |
| +、-      | 正负号                    |
| \*       | 声明指针；解引用指针             |
| &        | 取内存地址                  |
| ->       | 指向                     |
| .        | 取成员                    |
| ()       | 把某表达式看作一个整体            |
| []       | 解引用数组名                 |
| sizeof() | 返回一个数据类型或变量占有的字节数，int型 |
| (type)*  | 转换为指定类型的指针             |
| ,        | 从左到右执行每个子式，返回最后一个子式的值  |

## 运算符的优先级
- ()的优先级最高
- 一元 > 二元 > 三元
- && > || > 赋值

# 0x06 流程语句

### 1. if-else 语句
```c
if(condition0)
{
	// condition0 is ture(not 0)
}
else if (condition1)
{
	// condition1 is ture(not 0)
}
else
{
	// condition1 and 2 are both false(0)
}
```

### 2. switch 语句
switch语句的条件只能是整数或枚举类型，不能用来比较字符串！
```c
// condition只能是整数或枚举类型
switch(condition)
{
	case 1:
		...
		break;
	case 2:
		...
		break;
	case 3:
		...
		break;
	default:
		...
		break;
}
```

##### case穿透
- switch语句根据条件来判断跳转到哪个case继续执行程序
- 程序执行到break则跳出该switch语句体，执行后面的程序
- 如果该case的语句末尾没有break语句，则继续执行下面case中的语句，直到遇到break语句或者执行完整个switch语句体。

### 3.for 循环
```c
for(初始化语句; 条件表达式; 循环尾)
{
	循环体语句;
}
```
- 初始化语句只执行1次
- 循环尾在每次循环的循环体语句执行完后执行1次

### 4. while 循环
```c
while(条件)
{
	循环体语句;
}
```

### 5.do-while 循环
```c
do
{
	循环体语句;
} while(条件);
```
- 在循环之前先执行一次循环体语句
- 后续的执行过程与while循环一致

### 6. break和continue

#### break
- break语句用来退出语句体
- 用于退出循环，执行后续程序
- 在switch-case语句中用于推出语句体

#### continue
- continue语句只用于循环体语句中
- 用于结束本次循环，执行下一次循环

# 0x07 函数
像变量一样，函数在内存中也会占用空间，函数也有它的内存地址，但不同的是，函数被加载到内存中不可读写的代码段，而变量被加载到内存中可读写的数据段或栈段。

### 1. 函数的定义
需要注意的是，函数的定义包含了一个花括号包括的代码块，而代码块的末端无需像语句那样写上分号。函数的定义格式如下。
```c
返回值类型 函数名 (参数列表)
{
	函数体语句;
	return 返回值;
}
```

##### 函数头
返回值类型、函数名、参数列表所在的一行叫做**函数头**。

##### 函数体
除函数头之外，一对花括号和它所包含的语句体叫做**函数体**。

### 2. 函数的声明
```c
返回值类型 函数名 (参数列表);
```
- 声明用于告诉编译器某个已经存在的函数的返回值类型和名称及如何调用函数，但不分配存储空间，不提供函数体的实现。
- 函数的声明只写函数头，并且与变量的声明语句一样需要在末端加上分号。
- **定义是声明的一个特殊形式**。它不仅声明函数的存在，还为函数提供具体实现、分配存储空间。

### 3. 函数的参数
- 如果函数要使用参数，则必须声明接受参数值的变量
- 这些变量是作用域在函数体内的局部变量，称为函数的**形式参数**
- 形式参数变量在程序进入函数时创建，函数执行完毕时销毁
- 调用函数时向函数的参数列表写入的参数成为函数的**实际参数**

### 4. 函数的调用
在C语言程序中，函数在调用之前必须声明。
```c
/* 1.需要接收返回值的函数调用 */
int sum(int a, int b);  // 函数声明
int result = sum(A, B); // 函数调用
/* 2.没有或无需接收返回值的函数调用 */
void printInfo(void* info);
void* INFO;
printInfo(INFO);
```

按照调用函数时传入的参数分类，函数的调用可分为传值调用和传址(引用)调用。

| 调用类型 | 描述                                                                           |
| ---- | ---------------------------------------------------------------------------- |
| 传值调用 | 调用时把实际参数的值复制给函数的形式参数，修改函数内的形式参数变量不会影响实际参数变量。                                 |
| 引用调用 | 传入的实际参数是存储变量地址的指针变量，形参与实参一样是地址值。对形参解引用后操作时，与解引用实参一样，函数内的操作会影响实参和形参指向的内存中的内容。 |

# 0x08 指针和指针变量
- 指针就是内存地址，指针变量就是存储内存地址的变量
- 一个指针变量中存放另一个变量的内存地址，就称该指针变量**指向**另一个变量😊
- 指针变量的基类型，表示它所指向的变量的类型，表示它所指向的变量占用内存空间的大小
- 更改一个指针变量中存放的内存地址，这个动作叫做**移动**该指针
- 当指针指向的内存空间已被释放或不再有效，则称该指针**悬空**
- 声明后尚未初始化的指针称为**野指针**
- 悬空指针和野指针是程序中不安全的存在，当一个指针变量暂时不使用时应该将其值初始化为NULL，表示不指向任何地址，称为**空指针**

### 1. 指针变量的声明和初始化
指针变量的声明和初始化格式如下：
	`基类型 *指针变量 = &指向的变量；`
例如：
```c
int a = 10;
int *p = &a;
/* p是指向a的指针变量 */
```

### 2. 空指针
空指针是不指向任何地址的指针。
```c
int *ip = NULL;
char *cp = NULL;
```
NULL是标准库stdio.h或stddef.h中定义的：
```c
#define NULL ((void *)0)
```

### 3. "常量指针" 和 "指针常量"
`const char*` 并不是表示指针本身是常量，而是表示指针所指向的数据是**只读的**。
这意味着通过该指针无法修改字符串的内容，但指针本身仍然是可以移动的。

##### **1> 常量指针（**`const type*`**）**
- **定义**：常量指针是指向常量的指针变量，所指向的数据是**只读的**。
- **特点**：可以移动指针指向的位置，但不能改变指针指向的数据内容。
- **示例**：

```c
const char *ptr = "Hello";
ptr++;         // 合法，指针可以移动
*ptr = 'H';    // 错误，无法修改指针指向的内容
```

##### **2> 指针常量（**`type* const`**）**

- **定义**：指针本身是一个常量，但可以通过指针常量修改指向的内存中的数据内容。
- **特点**：指针始终指向同一个地址，不能改变指向的位置，但可以修改数据内容。
- **示例**：

```c
char data[] = "Hello";
char *const ptr = data;
*ptr = 'h';    // 合法，可以修改指针指向的内容
ptr++;         // 错误，指针不能移动
```

##### **3> 双重常量（**`const char* const`**）**
- **定义**：既不能修改指针本身的值，也不能修改指针指向的数据内容。
- **特点**：指针地址和数据内容都不可更改。
- **示例**：

```c
const char *const ptr = "Hello";
ptr++;         // 错误，指针地址不可更改
*ptr = 'h';    // 错误，指针指向的内
```

### 4. 与指针有关的运算符

##### 1> 取地址运算符(&)
表示取被操作对象的内存地址。

##### 2> 指针声明运算符(\*)
仅在声明指针变量时表示此义，标识指针变量。

##### 3> 解引用运算符(\*)
用于访问指针所指向的内存中的值。

##### 4> 数组下标运算符(\[])
用于访问指针指向的数组中的元素。

##### 5> 结构体指针成员访问运算符(->)
通过一个指向结构体的指针来访问结构体中的成员变量。

##### 6> 算术运算符
对指针变量进行偏移操作。

### 5. 函数指针
- 函数指针就是指向函数的指针，存储函数位于代码段中的地址
- 函数指针的类型与函数的返回值类型和参数的个数和类型有关

##### 函数指针变量的声明
`返回值类型 *指针名(参数1类型, 参数2类型, ...);`
- 在C语言中，函数名表示该函数的内存地址
- 函数名是一个指向函数的指针常量
例如：

```c
int max(int a, int b)
{
	if(a>=b)
	{return a;}
	else
	{return b;}
}
// 指向函数max()的指针
int (*func_ptr)(int, int) = max;
```

##### 回调函数
一个函数的某个参数是函数指针，该函数通过参数函数指针调用另一个被该参数指向的函数，这个被参数指向的函数就是回调函数。

### 6. 多级指针
二级指针就是指向指针的指针，声明和解引用如下：

```c
int a = 9;
int *p0 = &a;
int **p1 = &p0;
/* p1是一个二级指针，可以解引用2次 */
int *p2 = *p1;  // 解引用一次得到指针p0的地址
int b = **p1;   // 解引用2次得到a的地址
```

以此类推，多级指针的声明使用多个\*号。
